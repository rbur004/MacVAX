#include <types.h>#include <quickdraw.h>#include <controls.h>     #include <dialogs.h>#include <events.h>//#include <desk.h>//#include <OSEvents.h>#include <windows.h>#include <resources.h>#include	<StdIO.h>#include	<string.h>#include	<Strings.h>#define GOTOD_C#include "gotod.h"#include "mmemory.h"#include "docmds.h"#include "sym.h"#include "physmem.h"#include "progw.h"#pragma segment Alertsvoid goto_address(	long which){address pos = 0;long pos_set = 0;long temp;DialogPtr GoTo_Dialog;		/*dialog box for keyboard*/short 	theType;			/*dialog item type*/short 	itemHit;			/*which item selected in dialog*/Rect	itemBox; 			/*temp Rect for selected item box*/Handle	system_cbx_Hdl;		/*System Check Box handle*/Handle	virtual_rdb_Hdl;	/*Virtual Addressing Radio Button handle*/Handle	physical_rdb_Hdl;	/*Physical Addressing Radio Button handle*/Handle	theGoTodTxtHdl;		/*keypad text to send*/char 	theText[256];		/*temp string location*/long 	use_virtual_address;		/*cludge added for testing virtual memory*/long	use_physical_address;		/*cludge added for testing virtual memory*/	GoTo_Dialog = GetNewDialog(GOTO_RESID, (Ptr)0, (WindowPtr)-1);	GetDItem(GoTo_Dialog, WHERE_TXT, &theType, &theGoTodTxtHdl, &itemBox);	GetDItem(GoTo_Dialog, SYSTEM_CBX,&theType, &system_cbx_Hdl, &itemBox);	use_virtual_address = (which == USE_VIRTMEMW || which == USE_PROGMEMW) && IPR(MME) != 0;	use_physical_address = ! use_virtual_address;	GetDItem(GoTo_Dialog, VIRTUAL_RDB,&theType, &virtual_rdb_Hdl, &itemBox);	GetDItem(GoTo_Dialog, PHYSICAL_RDB,&theType, &physical_rdb_Hdl, &itemBox);	SetCtlValue((ControlHandle)virtual_rdb_Hdl , use_virtual_address);	SetCtlValue((ControlHandle)physical_rdb_Hdl, use_physical_address);	if((USE_VIRTMEMW && hex_mem_dump) || ((USE_PHYSMEMW || USE_PROGMEMW) && hexmode))	{		SetIText(theGoTodTxtHdl, (void *) "\p0x");	/*am expecting a 'c' string here*/		SelIText(GoTo_Dialog,WHERE_TXT,(short)3,(short)3);	}	else		SetIText(theGoTodTxtHdl, (void *) "");	/*am expecting a 'c' string here*/	/*get handles to text boxes*/	ShowWindow(GoTo_Dialog);				/* here I am */	SelectWindow(GoTo_Dialog);				/* here I am */	SetPort(GoTo_Dialog);					/* make later GlobalToLocal calls work right */	FlushEvents(everyEvent, 0);				/* throws out leftover clicks, keys */	for(;;)	{		do		{//			ModalDialog((ModalFilterProcPtr)0L, &itemHit);	/* calls theFilter for every  event */			ModalDialog(0L, &itemHit);	/* calls theFilter for every  event */		}while(itemHit <= 0);		switch(itemHit)		{		case SYSTEM_CBX:			SetCtlValue((ControlHandle)system_cbx_Hdl, GetCtlValue((ControlHandle)system_cbx_Hdl)^1);			break;		case VIRTUAL_RDB:			if(IPR(MME) == 1)			{				use_virtual_address = 1;				use_physical_address = 0;				SetCtlValue((ControlHandle)virtual_rdb_Hdl , use_virtual_address);				SetCtlValue((ControlHandle)physical_rdb_Hdl, use_physical_address);			}			break;		case PHYSICAL_RDB:			use_virtual_address  = 0;			use_physical_address = 1;			SetCtlValue((ControlHandle)virtual_rdb_Hdl , use_virtual_address);			SetCtlValue((ControlHandle)physical_rdb_Hdl, use_physical_address);			break;		case GoTo_OK:			theText[0] = '\0';			GetIText(theGoTodTxtHdl, (void *)theText);	/*am expecting a pascal string here*/			p2cstr((void *)theText);										if(theText[0] == '0' && (theText[1] == 'x' || theText[1] == 'X'))			{				sscanf(&theText[2],"%x",&pos);				pos_set = 1;			}			else if(strchr("0123456789",theText[0]))			{				sscanf(&theText[0],"%d",&pos);				pos_set = 1;			}			else if ( (temp = findsymbyname(&theText[0],GetCtlValue((ControlHandle)system_cbx_Hdl)) ) != -1)			{						pos_set = 1;						pos = (address) temp;			}			if(pos_set == 1)			{				switch(which)				{				case USE_VIRTMEMW:					if(use_physical_address && IPR(MME) == 1)						goto_loc(virtual(pos));					else						goto_loc(pos);					break;				case USE_PHYSMEMW:					if(use_virtual_address && IPR(MME) == 1)						physmemw_goto(check_reference(pos, KSP, RD, 0));					else						physmemw_goto(pos);					break;				case USE_PROGMEMW:					put_at_top_progwindow(pos);					break;				}			}			/*fall through to cancel*/		case GoTo_CANCEL:			CloseDialog(GoTo_Dialog);			return;		}	}}