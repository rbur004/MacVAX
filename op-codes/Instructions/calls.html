<!doctype html public "-//IETF//DTD HTML 2.0//EN">
<HTML>

<HEAD>
<TITLE>CALLS Instruction
</TITLE>
</HEAD>

<BODY>
<H2>CALLS Instruction</h2>

<table border=0 valign=top cellpadding=5>

<tr>	<td valign=top><b>Purpose:</b></td><td>To invoke a procedure with arguments located on the stack.</td>
<tr>	<td valign=top><b>Format:</b></td><td>opcode numarg.rl, dst.ab</td>
<tr>	<td valign=top><b>Operation:</b></td><td>
	{Push arg count};<br>
	{align stack};<br>
	{create stack frame};<br>
	{set arithmetic trap enables};<br>
	{set new values of AP, FP, PC};
	</td>
<tr>	<td valign=top><b>Condition<br>Codes:</b></td>
		<td>N &lt- 0;<br>
			Z &lt- 0;<br>
			V &lt- 0;<br>
			C &lt- 0;</td>
<tr>	<td valign=top><B>Exceptions:</B><td>Reserved Operand</td>
<tr>	<td valign=top><b>Opcodes:<b></td>
		<td>
			<table border=0 valign=top cellpadding=2>
			<tr> <td>FB</td><td>CALLS</td><td>Procedure with Stack Argument list</td>
			</table>
		</td>
<tr>	<td valign=top><b>Description:</b></td>
		<td>The number of arguments operand is pushed onto the stack as a long word. SP is saved in a temporary and then bits 1:0 are replaced by 0 so that the stack is long word aligned. The procedure entry mask is scanned from bit 11 to 0 and the contents of the registers whose number corresponds to set bits in the mask are pushed on the stack as long words. PC, FP and AP are pushed on the stack as longwords. The condition codes are cleared. A longword containing the saved two low bits of SP in bits 31:30, a 1 in bit 29 and a 0 in bit 28, the low 12 bits of the procedure entry mask in bits 27:16 and the PSW in bits 15:0 with T cleared is pushed onto the Stack. A longword 0 is pushed onto the stack. FP is replaced by SP. AP is replaced by the saved SP (the value of the stack pointer after the number of arguments operand was pushed onto the stack). The trap enables in the PSW are set to a known state. Integer overflow, and decimal overflow are affected according to bits 14 and 15 of the entry mask respectively; floating underflow is cleared. T-bit is unaffected. PC is replaced by the sum of destination operand plus 2 which transfers control to the called procedure at the byte beyond the entry mask.<td>
<tr>	<td valign=top><b>Notes:</b></td>
		<td><dl compact>
		<dt>1.<dd>If bits 13:12 of the entry mask are not 0, a reserved operand fault occurs.
		<dt>2.<dd>On a reserved operand fault, the condition codes are unpredictable.
		<dt>2.<dd>The procedure calling standard and the condition handling facility require the following register saving conventions. R0 and R1 are always available for function return values and are never saved in the entry mask. All registers R2 through R11 which are modified in the called procedure must be preserved in the mask.
		<dt>2.<dd>Normal use is to push the arglist onto the stack in reverse order prior to the CALLS. On return, the arglist is removed from the stack by the <A HREF="ret.html">RET</A> instruction.
		</dl></td>
</table>

</BODY>

</HTML>
