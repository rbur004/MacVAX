<HTML><HEAD><TITLE></TITLE></HEAD><BODY><IMG ALIGN=left SRC="pics/AS-Icon.GIF">	<center><h1>Assembler Guide</h1></center><br><p><hr><!-- --------------------------------------------------------- --><h2>Introduction</h2><ul>The assembler accepts a mix of UNIX and VMS assembler syntax. This, as any good UNIX man page would point out, is for historical reasons. The assembler produces BSD a.out files, again for historical reasons.</ul><p><h2>Labels</h2><ul>A label is any sequence of alphanumeric characters that starts with a letter and ends with a &quot:&quot.  A label is way of naming an address of a VAX instruction or of data. e.g.<listing>	Start:     ; declare the label Start </listing>We can then use the label anywhere we would normally use an address.eg.<listing>	brb	Start</listing>Note that the As assembler is case-sensitive.  Labels must have exactly the same sequence of upper and lowercase letters everywhere they are used to be recognized as the same label.<p>The BSD numeric labels <b>0</b> through <b>9</b> are also recognised by the assembler. Multiple numeric labels using the same number <B>may</B> exist in a program at one time. These are referenced in instructions, by appending a &quotb&quot to the number to refer to the previous label using that number, or by appending an &quotf&quot to refer to the next label using that number. eg.<listing>	1:	...		movl R0, R1		blss	2f		;branches forwards to the next label 2		bgtr	1f		;branches forwards to the next label 1		bequ	1b		;branches Backwards to the previous label 1	2:  ...	1:	...</listing><h3>Nb.</h3><ul>	The assembler translates numeric labels into the form <B>L</B>n, where n is a unique number selected to make the label unique.</ul></ul><h2>Comments</h2><ul>Comments can be used anywhere in the program.  A semicolon starts the comment, and the rest of the line will be ignored.<p>C-style comments are also supported, using  the characters &quot/*&quot to start the comment, and following it with the characters &quot*/&quot.<p>Blank and tab characters may be used freely in the assembly language program to make the program more readable.  Blank lines are ignored by the assembler.</ul></ul><h2>Directives</h2><ul>Directives are used to instruct the assembler to perform some special operation for the following statement, rather than treating it as a normal assembly language instruction.<p><B>.blkb</B>	expr<ul>Reserves expr bytes (8 bits) of memory and fills them with zero.<listing>	.byte	20		; reserves 20 bytes of space </listing></ul><p><B>.byte</B>		expr [ , expr ]<ul>Reserves one or more bytes (8 bits) of memory with values taken from the expressions, e.g.<listing>	.byte	3		; reserves one byte with contents 3 	.byte	2, 3, 5, 7	; reserves four consecutive bytes 				; with values 2, 3, 5, 7 </listing></ul><p><B>.blkw</B>	expr<ul>Reserves expr words (16 bits) of memory and fills them with zero.</ul><p><B>.word</B>	expr [ , expr ]<ul>Reserves one or more words (16 bits) of memory with values taken from the expressions.</ul><p><B>.blkl</B>		expr<ul>Reserves expr longwords (32 bits) of memory and fills them with zero.</ul><p><B>.long</B>		expr [ , expr ]<ul>Reserves one or more longwords (32 bits) of memory with values taken from the expressions.</ul><p><B>.ascii</B>		string [ , string ]<br><B>.asciz</B>	string [ , string ]<ul>Stores an ASCII string as consecutive bytes in memory.  Asciz terminates the string with a null character (a zero byte) while ascii does not.Strings consist of a sequence of ASCII characters enclosed in double quotes, e.g.<listing>	.ascii	"This is a string"</listing></ul><p><B>.float</B>	floatConstant [ , floatConstant]<ul>Reserves one or more F float format longwords (32 bits) of memory with values taken from the numbers.</ul><p><B>.enter</B>	^M&lt[rn, ... rm], [iv],[dv]&gt<ul>This is a special form of the <B>.word</B> directive used in a <B>.code</B> segment to reserve a word of memory for the procedure mask at the start of a procedure.<listing>	.enter	^M&ltr2, r3&gt	; Procedure mask to save r2 and r3 on entry</listing></ul><p><b>.space</b>	space_expr [ , fill_expr ]<ul>Reserves space_expr consecutive bytes in memory, and fills them with the value contained in fill_expr.  If fill_expr is omitted, it defaults to 0, e.g.<listing>	.space	12, 0xF		; fill 12 bytes with value 1510 		  	.space	20		; Reserve 20 bytes (filled with 0) 	</listing></ul><p>  <B>.fill</B>		rep_expr , size_expr , fill_expr<ul>Fill_expr, treated as an expression of size size_expr bytes, is assembled and replicated rep_expr times.  Note that size_expr must be between 1 and 8.<listing>	.fill	8, 2, 0xFFFF	; Reserve 8 words (16 bytes) with 				; value 0xFFFF </listing>				  </ul><p><B>.align</B>	align_expr [, fill_expr]<ul>The location counter is incremented to the next address which is divisible by 2<sup>align_expr bytes</sup>.  This is done by filling from 0 to 2<sup>align_expr</sup> bytes with the the low order byte of fill_expr.  If present, fill_expr must be absolute; otherwise it defaults to zero. eg.<listing>	.align	2		; Pads using null bytes to make location 				; counter evenly divisible by 4</listing></ul><p><B>.set</B>		name, expression<ul>Sets the value of name to expression.  Any existing value for name is overwritten.<listing>	.set	RecordSize, 12	.set	NoRecords, 8Array:	.blkb	RecordSize*NoRecords	; reserve 96 bytes </listing></ul><p>	<B>.include</B>	&quotfilename&quot<ul>Reads in the file filename, and assembles it as though it were part of the current file.</ul>	  <p><B>.origin</B>	address<ul>The code is generated from address address on. The <B>.origin</B> can only be used at the start of code segment 0. The data is relocated to the end of the generated code. The primary use for this directive is to relocate system code.</ul></ul>  <h2>Expressions</h2><ul>Expressions may consist of all normal arithmetic operations using any of the operators or <A HREF="#AS_CONSTANTS">constants</A> as shown below.  Precedence is the same as for normal arithmetic, but parentheses can be used to group expressions to ensure the expected order of evaluation. All operands are treated as 32 bit integers. Floating point constants, Quador  Oct constants may not be manipulated by operators. Expressions are evaluated at assembly time, <B>not</B> at run time.<p><h3>Operators</h3><ul>	<TABLE border=0 cellpadding=5 align=left>    <tr align=center>    	<th colspan=4>Unary  Operators</th>		<tr align=left>		<th>Operator</th> 		<th>Meaning</th> 		<th>Example</th> 		<th>Value left in r0</th>	<tr>		<td>-</td> 		<td>negate</td>			<td>movl #-1, r0</td>			<td align=right>-1</td>	<tr>		<td>~</td> 		<td>bit negate</td>		<td>movl #~0xFFFFFFFE, r0</td> 		<td align=right>0x1</td>    <tr align=center>    	<th colspan=4>Binary Operators</th>	<tr align=left>		<th>Operator</th> 		<th>Meaning</th> 		<th>Example</th> 		<th>Value left in r0</th>	<tr>		<td>&amp</td>			<td>bitwise and</td>			<td>movl #0xFFFF &amp 07, r0</td> 		<td align=right>7</td>	<tr>		<td>|</td>			<td>bitwise or</td>			<td>movl #01 | 05, r0</td>			<td align=right>5</td>	<tr>		<td>^</td>			<td>bitwise exclusive or</td>			<td>movl #07 ^ 05, r0</td>			<td align=right>2</td>	<tr>		<td>!</td>			<td>operand1 | ~operand2</td>			<td>movl #01 ! 05, r0</td>			<td align=right>0xFFFFFFFB</td>	<tr>		<td>*</td>			<td>multiplication</td>			<td>movl #12 * 7, r0</td> 		<td align=right>84</td>	<tr>		<td>/</td>			<td>integer division</td>			<td>movl #75 / 6, r0</td>			<td align=right>12</td>	<tr>		<td>%			<td>modulo</td> 		<td>movl #75 % 6, r0</td>			<td align=right>3</td>	<tr>		<td>+</td>			<td>addition</td>			<td>movl #7 + 4, r0</td>			<td align=right>11</td>	<tr>		<td>-</td>			<td>subtraction</td>			<td>movl #7 - 4, r0</td>			<td align=right>3</td>	<tr>		<td>&gt&gt</td>			<td>logical right shift</td>			<td>movl #8 &gt&gt 2, r0</td>			<td align=right>2</td>	<tr>		<td>&lt&lt</td>			<td>logical left shift</td>			<td>movl #1 &lt&lt 4, r0</td>			<td align=right>16</td>	</table></ul><p><A NAME="AS_CONSTANTS"></A><h3>Constants</h3><ul>	<TABLE border=0 cellpadding=5>		<TR><td>&ltdecimal constant&gt</td>			<td>8,16,32,64<br>		or 128 bits</td>		<td>a sequence of digits without<br>		a leading zero, e.g. 42</td>	<TR><td>&ltoctal constant&gt</td>		<td>8,16,32,64<br>		or 128 bits</td>		<td>a sequence of digits with<br>		 a leading zero, e.g. 052</td>	<TR><td>&lthex constant&gt</td>		<td>8,16,32,64<br>		or 128 bits</td>		<td>&quot0x&quot followed by a sequence<br>		 of digits, e.g. 0x2A</td>	<TR><td>&ltidentifier&gt</td>		<td>32 bit address<br>		 or symbol constant</td>		<td>a label or equate,<br>		e.g. brb start + 4</td>	<TR><td>'&ltletter&gt</td>			<td>8 bits</td>		<td>a single character,<br>		e.g. movl 'A, r0</td>	<TR><td>&ltfloat constant&gt</td>		<td>32 bits</td>		<td>a number of the form 0f켷.ne켷,<br>		eg.   0f5.723e-23</td>	<TR><td>&ltDfloat constant&gt</td>		<td>64 bits</td>		<td>a number of the form 0d켷.ne켷,<br>		eg.   0d5.723e-23<br>		Not supported by the MacVAX simulator</td>	<TR><td>&ltGfloat constant&gt</td>		<td>64 bits</td>		<td>a number of the form 0g켷.ne켷 ,<br>		eg.   0g5.723e-23<br>		Not supported by the MacVAX simulator</td>	<TR><td>&ltHfloat constant&gt</td>		<td>128 bits</td>		<td>a number of the form 0h켷.ne켷 ,<br>		eg.   0h5.723e-23<br>		Not supported by the MacVAX simulator</td>	</table></ul></ul></BODY></HTML>